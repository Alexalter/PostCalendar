<!--[* $Id$ *]-->
<!--[pnmodgetvar module='PostCalendar' name='pcEventsOpenInNewWindow' assign='in_new_window']-->
<!--[pnsecauthaction comp="::" inst=".*" level="ACCESS_ADD" assign="ACCESS_ADD"]-->
<!--[ if $smarty.get.theme eq "Printer" ]-->
    <!--[* page presented in printer theme *]-->
    <!--[ assign var="ACCESS_ADD" value=0 ]-->
    <!--[ assign var="PRINT_VIEW" value=1 ]-->
<!--[/if]-->
<!--[ if $PRINT_VIEW eq false ]-->
<!--[ include file="user/postcalendar_user_navigation.htm" ]-->
<!--[ /if ]-->

<!--[ pc_pagejs_init ]-->

<h2><!--[gt text='Month list view']--></h2>

<h2 class="postcalendar_header">
    <!--[ if $PRINT_VIEW eq false ]--><a href="<!--[ $PREV_MONTH_URL ]-->">&lt;&lt;</a><!--[/if]-->
    <!--[ $DATE|pc_date_format:'%B %Y']-->
    <!--[ if $PRINT_VIEW eq false ]--><a href="<!--[ $NEXT_MONTH_URL ]-->">&gt;&gt;</a><!--[/if]-->
</h2>

<div class="calcontainer">
    <!--[ * CREATE THE LIST * ]-->
    <!--[ foreach name=weeks item=days from=$CAL_FORMAT ]-->
        <!--[ foreach name=days item=date from=$days ]-->
            <!--[ *sort the events by category so we can make it pretty* ]-->
            <!--[ pc_sort_events var="S_EVENTS" sort="time" order="asc" value=$A_EVENTS ]-->
            <!--[ if count($S_EVENTS.$date) gt 0 ]-->
            <ul class="eventslist" 
            <!--[if $in_new_window eq false]-->onclick="javascript:location.href='<!--[ pc_url action=day date=$date ]-->';"<!--[/if]-->>
            <!--[ foreach name=events item=event from=$S_EVENTS.$date ]-->
                <!--[ if $smarty.foreach.events.first eq true ]--><li class="dayheader" style='margin-top: .5em;'><!--[ $date|pc_date_format ]--></li><!--[/if]-->

                <!--[ if $event.alldayevent != true ]-->
                    <!--[ if $24HOUR_TIME ]-->
                        <!--[ assign var="timestamp" value=$event.startTime|date_format:'%H:%M']-->
                    <!--[ else ]-->
                        <!--[ assign var="timestamp" value=$event.startTime|date_format:'%l:%M %p']-->
                    <!--[ /if ]-->
                <!--[ else ]-->
                    <!--[ assign var="timestamp" value="" ]-->
                <!--[ /if ]-->
                <!--[ assign var="title" value=$event.title|strip_tags ]-->

                <!--[ assign var="desc" value=$event.hometext|truncate:255:"..." ]-->
                <li class="eventslistitems">
                    <span style="padding: 1px 1em; color: <!--[$event.cattextcolor]-->; background: <!--[ $event.catcolor ]-->;"><!--[ $event.catname ]--></span>
                    <!--[ $timestamp ]-->&nbsp;
                    <!--[ pc_url full=true action=detail eid=$event.eid date=$date style="text-decoration: none;" display=$title]-->
                    <!--[ if $event.alldayevent != true ]-->
                        (<!--[ $event.duration ]-->)
                    <!--[ else ]-->
                        (<!--[gt text='All-day event']-->)
                    <!--[/if]-->
                </li>
            <!--[ /foreach ]-->
            </ul>
            <!--[ /if ]--><!--[* end if isset($S_EVENTS) *]-->
        <!--[ /foreach ]-->
    <!--[ /foreach ]-->
</div><!-- end calcontainer -->
<div style='text-align:right;'>
    <!--[ if $PRINT_VIEW eq true ]-->
        <!--[ assign var="viewtype" value=$smarty.get.viewtype ]-->
        <!--[if ((empty($smarty.get.viewtype)) or (!isset($smarty.get.viewtype)))]-->
            <!--[pnmodgetvar module="PostCalendar" name="pcDefaultView" assign="viewtype" ]-->
        <!--[/if]-->
        <a href="<!--[pnmodurl modname="PostCalendar" func="view" viewtype=$viewtype Date=$smarty.get.Date ]-->"><!--[gt text='Return']--></a>
    <!--[/if]-->
</div>
<!--[ include file="user/postcalendar_user_footer.htm" ]-->
